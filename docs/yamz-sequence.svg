<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1287px" preserveAspectRatio="none" style="width:1017px;height:1287px;" version="1.1" viewBox="0 0 1017 1287" width="1017px" zoomAndPan="magnify"><defs><filter height="300%" id="f8x7pkb9mufsp" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="1272.1406" style="stroke: #A80036; stroke-width: 1.0;" width="89" x="9" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="31" y="16.0669">App A</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="11" y="31.1997">main thread</text><rect fill="#DDDDDD" height="1272.1406" style="stroke: #A80036; stroke-width: 1.0;" width="343" x="100" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="144" x="199.5" y="16.0669">App A client thread</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="262" x="140.5" y="31.1997">(eg appfwk module worker thread)</text><rect fill="#DDDDDD" height="1272.1406" style="stroke: #A80036; stroke-width: 1.0;" width="144" x="519" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="88" x="547" y="16.0669">App A (ysA)</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="100" x="543.5" y="31.1997">server thread</text><rect fill="#DDDDDD" height="1272.1406" style="stroke: #A80036; stroke-width: 1.0;" width="145" x="686.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="88" x="715" y="16.0669">App B (ysB)</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="100" x="711.5" y="31.1997">server thread</text><rect fill="#DDDDDD" height="1272.1406" style="stroke: #A80036; stroke-width: 1.0;" width="145" x="849.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="88" x="878" y="16.0669">App C (ysC)</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="100" x="874.5" y="31.1997">server thread</text><rect fill="#FFFFFF" filter="url(#f8x7pkb9mufsp)" height="80.3984" style="stroke: #000000; stroke-width: 2.0;" width="637.5" x="37.5" y="85.5625"/><rect fill="#FFFFFF" filter="url(#f8x7pkb9mufsp)" height="347.9609" style="stroke: #000000; stroke-width: 2.0;" width="549.5" x="129.5" y="208.0938"/><rect fill="#FFFFFF" filter="url(#f8x7pkb9mufsp)" height="604.6563" style="stroke: #000000; stroke-width: 2.0;" width="877" x="129.5" y="611.1875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="53.5" x2="53.5" y1="73.5625" y2="1234.8438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="145.5" x2="145.5" y1="73.5625" y2="1234.8438"/><rect fill="#FFFFFF" filter="url(#f8x7pkb9mufsp)" height="1038.75" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="140.5" y="196.0938"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="255" x2="255" y1="73.5625" y2="1234.8438"/><rect fill="#FFFFFF" filter="url(#f8x7pkb9mufsp)" height="983.4844" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="250" y="251.3594"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="381" x2="381" y1="73.5625" y2="1234.8438"/><rect fill="#FFFFFF" filter="url(#f8x7pkb9mufsp)" height="825.8203" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="376" y="409.0234"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="591" x2="591" y1="73.5625" y2="1234.8438"/><rect fill="#FFFFFF" filter="url(#f8x7pkb9mufsp)" height="1076.8828" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="586" y="157.9609"/><rect fill="#FFFFFF" filter="url(#f8x7pkb9mufsp)" height="678.7891" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="591" y="556.0547"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="759" x2="759" y1="73.5625" y2="1234.8438"/><rect fill="#FFFFFF" filter="url(#f8x7pkb9mufsp)" height="391.2266" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="754" y="599.1875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="922" x2="922" y1="73.5625" y2="1234.8438"/><rect fill="#FFFFFF" filter="url(#f8x7pkb9mufsp)" height="354.9609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="917" y="879.8828"/><rect fill="#FEFECE" filter="url(#f8x7pkb9mufsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="57" x="23" y="38.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="30" y="58.2607">main()</text><rect fill="#FEFECE" filter="url(#f8x7pkb9mufsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="79" x="104" y="38.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="111" y="58.2607">app code</text><rect fill="#FEFECE" filter="url(#f8x7pkb9mufsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="197" y="38.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="204" y="58.2607">yamz::Client 1</text><rect fill="#FEFECE" filter="url(#f8x7pkb9mufsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="323" y="38.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="330" y="58.2607">yamz::Client 2</text><rect fill="#FEFECE" filter="url(#f8x7pkb9mufsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="523" y="38.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="530" y="58.2607">yamz::Server ysA</text><rect fill="#FEFECE" filter="url(#f8x7pkb9mufsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="690.5" y="38.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="697.5" y="58.2607">yamz::Server ysB</text><rect fill="#FEFECE" filter="url(#f8x7pkb9mufsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="853.5" y="38.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="860.5" y="58.2607">yamz::Server ysC</text><rect fill="#FEFECE" filter="url(#f8x7pkb9mufsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="57" x="23" y="1234.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="30" y="1254.8389">main()</text><rect fill="#FEFECE" filter="url(#f8x7pkb9mufsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="79" x="104" y="1234.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="111" y="1254.8389">app code</text><rect fill="#FEFECE" filter="url(#f8x7pkb9mufsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="197" y="1234.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="204" y="1254.8389">yamz::Client 1</text><rect fill="#FEFECE" filter="url(#f8x7pkb9mufsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="323" y="1234.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="330" y="1254.8389">yamz::Client 2</text><rect fill="#FEFECE" filter="url(#f8x7pkb9mufsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="523" y="1234.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="530" y="1254.8389">yamz::Server ysA</text><rect fill="#FEFECE" filter="url(#f8x7pkb9mufsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="690.5" y="1234.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="697.5" y="1254.8389">yamz::Server ysB</text><rect fill="#FEFECE" filter="url(#f8x7pkb9mufsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="853.5" y="1234.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="860.5" y="1254.8389">yamz::Server ysC</text><path d="M37.5,85.5625 L328.5,85.5625 L328.5,92.5625 L318.5,102.5625 L37.5,102.5625 L37.5,85.5625 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="80.3984" style="stroke: #000000; stroke-width: 2.0;" width="637.5" x="37.5" y="85.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="246" x="52.5" y="98.6294">Start yamz server internal to app</text><polygon fill="#A80036" points="579,124.8281,589,128.8281,579,132.8281,583,128.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="53.5" x2="585" y1="128.8281" y2="128.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="60.5" y="123.7622">ctor("expect two clients")</text><polygon fill="#A80036" points="574,153.9609,584,157.9609,574,161.9609,578,157.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="53.5" x2="580" y1="157.9609" y2="157.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="60.5" y="152.895">start()</text><polygon fill="#A80036" points="128.5,192.0938,138.5,196.0938,128.5,200.0938,132.5,196.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="53.5" x2="134.5" y1="196.0938" y2="196.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="60.5" y="191.0278">ctor()</text><path d="M129.5,208.0938 L461.5,208.0938 L461.5,215.0938 L451.5,225.0938 L129.5,225.0938 L129.5,208.0938 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="347.9609" style="stroke: #000000; stroke-width: 2.0;" width="549.5" x="129.5" y="208.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="287" x="144.5" y="221.1606">Construct clients which make requests</text><polygon fill="#A80036" points="238,247.3594,248,251.3594,238,255.3594,242,251.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="150.5" x2="244" y1="251.3594" y2="251.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="157.5" y="246.2935">ctor(cfg)</text><polygon fill="#A80036" points="574,247.3594,584,251.3594,574,255.3594,578,251.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="260" x2="580" y1="251.3594" y2="251.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="267" y="246.2935">connect</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="260" x2="302" y1="280.4922" y2="280.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="302" x2="302" y1="280.4922" y2="293.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="261" x2="302" y1="293.4922" y2="293.4922"/><polygon fill="#A80036" points="271,289.4922,261,293.4922,271,297.4922,267,293.4922" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="267" y="275.4263">make ports</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="260" x2="302" y1="322.625" y2="322.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="302" x2="302" y1="322.625" y2="335.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="261" x2="302" y1="335.625" y2="335.625"/><polygon fill="#A80036" points="271,331.625,261,335.625,271,339.625,267,335.625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="267" y="317.5591">do binds</text><polygon fill="#A80036" points="574,375.8906,584,379.8906,574,383.8906,578,379.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="260" x2="580" y1="379.8906" y2="379.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="267" y="359.6919">msg:request(ysB)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="267" y="374.8247">number 1/2</text><polygon fill="#A80036" points="364,405.0234,374,409.0234,364,413.0234,368,409.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="150.5" x2="370" y1="409.0234" y2="409.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="157.5" y="403.9575">ctor(cfg)</text><polygon fill="#A80036" points="574,405.0234,584,409.0234,574,413.0234,578,409.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="386" x2="580" y1="409.0234" y2="409.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="393" y="403.9575">connect</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="386" x2="428" y1="438.1563" y2="438.1563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="428" x2="428" y1="438.1563" y2="451.1563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="387" x2="428" y1="451.1563" y2="451.1563"/><polygon fill="#A80036" points="397,447.1563,387,451.1563,397,455.1563,393,451.1563" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="393" y="433.0903">make ports</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="386" x2="428" y1="480.2891" y2="480.2891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="428" x2="428" y1="480.2891" y2="493.2891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="387" x2="428" y1="493.2891" y2="493.2891"/><polygon fill="#A80036" points="397,489.2891,387,493.2891,397,497.2891,393,493.2891" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="393" y="475.2231">do binds</text><polygon fill="#A80036" points="574,533.5547,584,537.5547,574,541.5547,578,537.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="386" x2="580" y1="537.5547" y2="537.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="393" y="517.356">msg:request(ysB,ysC)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="393" y="532.4888">number 2/2</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="596" x2="643" y1="535.0547" y2="535.0547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="643" x2="643" y1="535.0547" y2="548.0547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="602" x2="643" y1="548.0547" y2="548.0547"/><polygon fill="#A80036" points="612,544.0547,602,548.0547,612,552.0547,608,548.0547" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="608" y="529.9888">online()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="759" x2="806" y1="586.1875" y2="586.1875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="806" x2="806" y1="586.1875" y2="599.1875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="765" x2="806" y1="599.1875" y2="599.1875"/><polygon fill="#A80036" points="775,595.1875,765,599.1875,775,603.1875,771,599.1875" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="38" x="771" y="581.1216">online</text><path d="M129.5,611.1875 L728.5,611.1875 L728.5,618.1875 L718.5,628.1875 L129.5,628.1875 L129.5,611.1875 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="604.6563" style="stroke: #000000; stroke-width: 2.0;" width="877" x="129.5" y="611.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="554" x="144.5" y="624.2544">Server replies to client driven by peers, app polls client to process queues</text><polygon fill="#A80036" points="612,650.4531,602,654.4531,612,658.4531,608,654.4531" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="742,650.4531,752,654.4531,742,658.4531,746,654.4531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="606" x2="748" y1="654.4531" y2="654.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="618" y="649.3872">Zyre ENTER ysB/ysA</text><polygon fill="#A80036" points="271,694.7188,261,698.7188,271,702.7188,267,698.7188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="265" x2="585" y1="698.7188" y2="698.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="277" y="678.52">msg:reply(ysB connects)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="277" y="693.6528">queue</text><polygon fill="#A80036" points="397,738.9844,387,742.9844,397,746.9844,393,742.9844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="391" x2="585" y1="742.9844" y2="742.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="403" y="722.7856">msg:reply(ysB connects)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="403" y="737.9185">queue</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="150.5" x2="192.5" y1="740.4844" y2="740.4844"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="192.5" x2="192.5" y1="740.4844" y2="753.4844"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="151.5" x2="192.5" y1="753.4844" y2="753.4844"/><polygon fill="#A80036" points="161.5,749.4844,151.5,753.4844,161.5,757.4844,157.5,753.4844" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="29" x="157.5" y="735.4185">work</text><polygon fill="#A80036" points="238,781.1172,248,785.1172,238,789.1172,242,785.1172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="150.5" x2="244" y1="785.1172" y2="785.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="157.5" y="780.0513">discover()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="260" x2="302" y1="782.6172" y2="782.6172"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="302" x2="302" y1="782.6172" y2="795.6172"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="261" x2="302" y1="795.6172" y2="795.6172"/><polygon fill="#A80036" points="271,791.6172,261,795.6172,271,799.6172,267,795.6172" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="267" y="777.5513">connect(ysB)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="150.5" x2="192.5" y1="824.75" y2="824.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="192.5" x2="192.5" y1="824.75" y2="837.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="151.5" x2="192.5" y1="837.75" y2="837.75"/><polygon fill="#A80036" points="161.5,833.75,151.5,837.75,161.5,841.75,157.5,837.75" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="29" x="157.5" y="819.6841">work</text><polygon fill="#A80036" points="238,865.3828,248,869.3828,238,873.3828,242,869.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="150.5" x2="244" y1="869.3828" y2="869.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="157.5" y="864.3169">discover()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="260" x2="302" y1="866.8828" y2="866.8828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="302" x2="302" y1="866.8828" y2="879.8828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="261" x2="302" y1="879.8828" y2="879.8828"/><polygon fill="#A80036" points="271,875.8828,261,879.8828,271,883.8828,267,879.8828" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="267" y="861.8169">noop</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="922" x2="969" y1="866.8828" y2="866.8828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="969" x2="969" y1="866.8828" y2="879.8828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="928" x2="969" y1="879.8828" y2="879.8828"/><polygon fill="#A80036" points="938,875.8828,928,879.8828,938,883.8828,934,879.8828" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="38" x="934" y="861.8169">online</text><polygon fill="#A80036" points="612,905.0156,602,909.0156,612,913.0156,608,909.0156" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="905,905.0156,915,909.0156,905,913.0156,909,909.0156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="606" x2="911" y1="909.0156" y2="909.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="618" y="903.9497">Zyre ENTER ysC/ysA</text><polygon fill="#A80036" points="775,949.2813,765,953.2813,775,957.2813,771,953.2813" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="905,949.2813,915,953.2813,905,957.2813,909,953.2813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="769" x2="911" y1="953.2813" y2="953.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="781" y="948.2153">Zyre ENTER ysC/ysB</text><polygon fill="#A80036" points="397,949.2813,387,953.2813,397,957.2813,393,953.2813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="391" x2="585" y1="953.2813" y2="953.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="403" y="933.0825">msg:reply(ysC connects)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="403" y="948.2153">queue</text><polygon fill="#A80036" points="612,978.4141,602,982.4141,612,986.4141,608,982.4141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="606" x2="753" y1="982.4141" y2="982.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="618" y="977.3481">Zyre EXIT ysB</text><polygon fill="#A80036" points="905,978.4141,915,982.4141,905,986.4141,909,982.4141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="764" x2="911" y1="982.4141" y2="982.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="771" y="977.3481">Zyre EXIT ysB</text><polygon fill="#A80036" points="271,1022.6797,261,1026.6797,271,1030.6797,267,1026.6797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="265" x2="585" y1="1026.6797" y2="1026.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="277" y="1006.481">msg:reply(ysB disconnects)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="277" y="1021.6138">queue</text><polygon fill="#A80036" points="397,1066.9453,387,1070.9453,397,1074.9453,393,1070.9453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="391" x2="585" y1="1070.9453" y2="1070.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="403" y="1050.7466">msg:reply(ysB disconnects)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="403" y="1065.8794">queue</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="150.5" x2="192.5" y1="1068.4453" y2="1068.4453"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="192.5" x2="192.5" y1="1068.4453" y2="1081.4453"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="151.5" x2="192.5" y1="1081.4453" y2="1081.4453"/><polygon fill="#A80036" points="161.5,1077.4453,151.5,1081.4453,161.5,1085.4453,157.5,1081.4453" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="29" x="157.5" y="1063.3794">work</text><polygon fill="#A80036" points="364,1109.0781,374,1113.0781,364,1117.0781,368,1113.0781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="150.5" x2="370" y1="1113.0781" y2="1113.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="157.5" y="1108.0122">discover()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="386" x2="428" y1="1110.5781" y2="1110.5781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="428" x2="428" y1="1110.5781" y2="1123.5781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="387" x2="428" y1="1123.5781" y2="1123.5781"/><polygon fill="#A80036" points="397,1119.5781,387,1123.5781,397,1127.5781,393,1123.5781" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="393" y="1105.5122">connect(ysB)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="386" x2="428" y1="1152.7109" y2="1152.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="428" x2="428" y1="1152.7109" y2="1165.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="387" x2="428" y1="1165.7109" y2="1165.7109"/><polygon fill="#A80036" points="397,1161.7109,387,1165.7109,397,1169.7109,393,1165.7109" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="393" y="1147.645">connect(ysC)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="386" x2="428" y1="1194.8438" y2="1194.8438"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="428" x2="428" y1="1194.8438" y2="1207.8438"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="387" x2="428" y1="1207.8438" y2="1207.8438"/><polygon fill="#A80036" points="397,1203.8438,387,1207.8438,397,1211.8438,393,1207.8438" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="393" y="1189.7778">disconnect(ysB)</text><!--MD5=[cb7808fd609ccad11d979ba6018fb726]
@startuml
!pragma teoz true
box "App A\n main thread"
        participant "main()" as main
end box
box "App A client thread\n(eg appfwk module worker thread)"
        participant "app code" as app
        participant "yamz::Client 1" as yc1
        participant "yamz::Client 2" as yc2
end box
box "App A (ysA)\n server thread"
        participant "yamz::Server ysA" as ysA
end box
box "App B (ysB)\n server thread"
        participant "yamz::Server ysB" as ysB
end box
box "App C (ysC)\n server thread"
        participant "yamz::Server ysC" as ysC
end box

group Start yamz server internal to app
main -> ysA : ctor("expect two clients")
main -> ysA : start()
activate ysA
end

main -> app : ctor()
activate app

group Construct clients which make requests

app -> yc1 : ctor(cfg)
activate yc1
& yc1 -> ysA : connect
yc1 -> yc1 : make ports
yc1 -> yc1 : do binds
yc1 -> ysA : msg:request(ysB)\nnumber 1/2

app -> yc2 : ctor(cfg)
activate yc2
& yc2 -> ysA : connect
yc2 -> yc2 : make ports
yc2 -> yc2 : do binds
yc2 -> ysA : msg:request(ysB,ysC)\nnumber 2/2

& ysA -> ysA : online()
activate ysA
end 

ysB -> ysB : online
activate ysB

group Server replies to client driven by peers, app polls client to process queues

ysB <-> ysA : Zyre ENTER ysB/ysA

                
ysA - -> yc1 : msg:reply(ysB connects)\nqueue
ysA - -> yc2 : msg:reply(ysB connects)\nqueue
& app -> app : work
app -> yc1 : discover()
& yc1 -> yc1 : connect(ysB)                

app -> app : work
app -> yc1 : discover()
& yc1 -> yc1 : noop                        

& ysC -> ysC : online
activate ysC
ysC <-> ysA : Zyre ENTER ysC/ysA
ysC <-> ysB : Zyre ENTER ysC/ysB

& ysA - -> yc2 : msg:reply(ysC connects)\nqueue

ysB -> ysA : Zyre EXIT ysB
& ysB -> ysC : Zyre EXIT ysB
destroy ysB
ysA - -> yc1 : msg:reply(ysB disconnects)\nqueue
ysA - -> yc2 : msg:reply(ysB disconnects)\nqueue

& app -> app : work
app -> yc2 : discover()
& yc2 -> yc2 : connect(ysB)
yc2 -> yc2 : connect(ysC)
yc2 -> yc2 : disconnect(ysB)

@enduml

PlantUML version 1.2020.01(Sun Feb 16 12:40:32 EST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_275-8u275-b01-0ubuntu1~18.04-b01
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>